<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор вартості рамок</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin
        src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // ============================================================================
        // КОНФІГУРАЦІЯ
        // ============================================================================

        const SHOW_ITEM_PRICES = false;
        const GOOGLE_SHEETS_ID = '1W3NoKoATbbQ7FaCyxLkfksWOdEvcT1KT44aMrkcvdxo';

        // ============================================================================
        // ЗАВАНТАЖЕННЯ ДАНИХ З GOOGLE SHEETS
        // ============================================================================

        async function loadDataFromGoogleSheets(sheetId) {
            try {
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;
                const response = await fetch(url);
                const text = await response.text();

                // Парсимо відповідь (Google повертає JSONP)
                const jsonText = text.substring(47).slice(0, -2);
                const json = JSON.parse(jsonText);

                const rows = json.table.rows;
                const baguetteData = [];

                // Пропускаємо перший рядок (заголовки)
                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i];
                    if (row.c && row.c[0] && row.c[0].v) {
                        const article = row.c[0]?.v || '';
                        const model = row.c[1]?.v || '';
                        const color = row.c[2]?.v || '';
                        const pricePerMeter = parseFloat(row.c[3]?.v) || 0;
                        const width = parseFloat(row.c[4]?.v) || 0;
                        const additionalSize = parseFloat(row.c[5]?.v) || 0;

                        if (article && pricePerMeter > 0) {
                            baguetteData.push({
                                article,
                                model,
                                color,
                                pricePerMeter,
                                width,
                                additionalSize
                            });
                        }
                    }
                }

                return baguetteData;
            } catch (error) {
                console.error('Помилка завантаження даних:', error);
                return null;
            }
        }

        // ============================================================================
        // ТЕСТОВІ ДАНІ
        // ============================================================================

        const MOCK_DATA = {
            baguette: [
                { article: 'AM1515-015', model: 'AM1515', color: '015', pricePerMeter: 150, width: 30, additionalSize: 12 },
                { article: 'AM1515-020', model: 'AM1515', color: '020', pricePerMeter: 150, width: 30, additionalSize: 12 },
                { article: 'DM1715-073', model: 'DM1715', color: '073', pricePerMeter: 220, width: 45, additionalSize: 15 },
                { article: 'BK2020-001', model: 'BK2020', color: '001', pricePerMeter: 180, width: 35, additionalSize: 13 },
            ],
            passepartout: [
                { article: 'P-001', name: 'Паспарту біле 1.5мм', pricePerM2: 80 },
                { article: 'P-002', name: 'Паспарту чорне 2мм', pricePerM2: 95 },
                { article: 'P-003', name: 'Паспарту кремове 1.5мм', pricePerM2: 85 },
            ],
            components: {
                innerWall: [
                    { name: 'ДВП', pricePerM2: 45, type: 'area' },
                    { name: 'Біле ДВП', pricePerM2: 55, type: 'area' },
                    { name: 'Підрамник', pricePerMeter: 35, type: 'perimeter' },
                    { name: 'ДВП + Підрамник', pricePerM2: 45, pricePerMeter: 35, type: 'combined' },
                    { name: 'Без нічого', pricePerM2: 0, type: 'none' },
                ],
                glass: [
                    { name: 'Скло звичайне', pricePerM2: 120 },
                    { name: 'Скло антиблікове', pricePerM2: 180 },
                    { name: 'Скло акрилове', pricePerM2: 150 },
                    { name: 'Без скла', pricePerM2: 0 },
                ],
                backWall: [
                    { name: 'Задник картон', pricePerM2: 30 },
                    { name: 'Задник ДВП', pricePerM2: 40 },
                    { name: 'Без задніка', pricePerM2: 0 },
                ],
                mounting: [
                    { name: 'Вушка', price: 15 },
                    { name: 'Вушка + ніжка', price: 25 },
                    { name: 'Без кріплення', price: 0 },
                ],
            },
            workTypes: [
                { name: 'Натяжка', price: 200 },
                { name: 'Оформлення', price: 150 },
                { name: 'Зшивка рамки', price: 100 },
            ],
        };

        // ============================================================================
        // ІКОНКИ
        // ============================================================================

        const SearchIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        );

        const PlusIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
            </svg>
        );

        const XIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
        );

        // ============================================================================
        // КОМПОНЕНТ
        // ============================================================================

        function FrameCalculator() {
            const [data, setData] = useState(MOCK_DATA);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            const [baguetteSearch, setBaguetteSearch] = useState('');
            const [selectedBaguette, setSelectedBaguette] = useState(null);
            const [withPassepartout, setWithPassepartout] = useState(false);
            const [width, setWidth] = useState('');
            const [height, setHeight] = useState('');

            const [passepartout1Search, setPassepartout1Search] = useState('');
            const [selectedPassepartout1, setSelectedPassepartout1] = useState(null);
            const [passepartout1Field, setPassepartout1Field] = useState('');
            const [showPassepartout2, setShowPassepartout2] = useState(false);
            const [passepartout2Search, setPassepartout2Search] = useState('');
            const [selectedPassepartout2, setSelectedPassepartout2] = useState(null);
            const [passepartout2Field, setPassepartout2Field] = useState('');

            const [innerWall, setInnerWall] = useState(data.components.innerWall[0].name);
            const [glass, setGlass] = useState(data.components.glass[0].name);
            const [backWall, setBackWall] = useState(data.components.backWall[0].name);
            const [mounting, setMounting] = useState(data.components.mounting[0].name);
            const [workType, setWorkType] = useState(data.workTypes[0].name);

            // Завантажуємо дані з Google Sheets при монтуванні компонента
            useEffect(() => {
                async function loadData() {
                    setLoading(true);
                    const baguetteData = await loadDataFromGoogleSheets(GOOGLE_SHEETS_ID);

                    if (baguetteData && baguetteData.length > 0) {
                        setData(prevData => ({
                            ...prevData,
                            baguette: baguetteData
                        }));
                        setError(null);
                    } else {
                        setError('Не вдалося завантажити дані. Використовуються тестові дані.');
                    }

                    setLoading(false);
                }

                loadData();
            }, []);

            const filteredBaguettes = useMemo(() => {
                if (!baguetteSearch.trim()) return [];
                const search = baguetteSearch.toLowerCase();
                return data.baguette.filter(b => b.article.toLowerCase().includes(search)).slice(0, 10);
            }, [baguetteSearch, data.baguette]);

            const filteredPassepartout1 = useMemo(() => {
                if (!passepartout1Search.trim()) return [];
                const search = passepartout1Search.toLowerCase();
                return data.passepartout.filter(p =>
                    p.article.toLowerCase().includes(search) || p.name.toLowerCase().includes(search)
                ).slice(0, 10);
            }, [passepartout1Search, data.passepartout]);

            const filteredPassepartout2 = useMemo(() => {
                if (!passepartout2Search.trim()) return [];
                const search = passepartout2Search.toLowerCase();
                return data.passepartout.filter(p =>
                    p.article.toLowerCase().includes(search) || p.name.toLowerCase().includes(search)
                ).slice(0, 10);
            }, [passepartout2Search, data.passepartout]);

            const calculations = useMemo(() => {
                if (!selectedBaguette || !width || !height) {
                    return { total: 0, details: [] };
                }

                const w = parseFloat(width);
                const h = parseFloat(height);

                if (isNaN(w) || isNaN(h) || w <= 0 || h <= 0) {
                    return { total: 0, details: [] };
                }

                let total = 0;
                const details = [];
                let innerWidth = w;
                let innerHeight = h;

                if (withPassepartout && selectedPassepartout1 && passepartout1Field) {
                    const field1 = parseFloat(passepartout1Field);
                    if (!isNaN(field1) && field1 > 0) {
                        let field1Actual = field1;

                        if (showPassepartout2 && selectedPassepartout2 && passepartout2Field) {
                            const field2 = parseFloat(passepartout2Field);
                            if (!isNaN(field2) && field2 > 0) {
                                field1Actual = field1 + field2;

                                const p2Width = (w + field2 * 2) / 1000;
                                const p2Height = (h + field2 * 2) / 1000;
                                const p2Area = p2Width * p2Height;
                                const p2Cost = p2Area * selectedPassepartout2.pricePerM2;
                                total += p2Cost;
                                details.push({
                                    name: `Паспарту (верхнє): ${selectedPassepartout2.name}`,
                                    value: `${p2Area.toFixed(4)} м² × ${selectedPassepartout2.pricePerM2} грн`,
                                    cost: p2Cost
                                });
                            }
                        }

                        const p1Width = (w + field1Actual * 2) / 1000;
                        const p1Height = (h + field1Actual * 2) / 1000;
                        const p1Area = p1Width * p1Height;
                        const p1Cost = p1Area * selectedPassepartout1.pricePerM2;
                        total += p1Cost;
                        details.push({
                            name: `Паспарту (нижнє): ${selectedPassepartout1.name}`,
                            value: `${p1Area.toFixed(4)} м² × ${selectedPassepartout1.pricePerM2} грн`,
                            cost: p1Cost
                        });

                        innerWidth = w + field1Actual * 2;
                        innerHeight = h + field1Actual * 2;
                    }
                }

                const outerWidth = innerWidth + selectedBaguette.additionalSize * 2;
                const outerHeight = innerHeight + selectedBaguette.additionalSize * 2;

                const baguettePerimeter = ((outerWidth + outerHeight) * 2) / 1000;
                const baguetteCost = baguettePerimeter * selectedBaguette.pricePerMeter;
                total += baguetteCost;
                details.push({
                    name: `Багет: ${selectedBaguette.article}`,
                    value: `${baguettePerimeter.toFixed(3)} м × ${selectedBaguette.pricePerMeter} грн`,
                    cost: baguetteCost
                });

                const innerWallItem = data.components.innerWall.find(item => item.name === innerWall);
                if (innerWallItem && innerWallItem.type !== 'none') {
                    const innerArea = (innerWidth * innerHeight) / 1000000;

                    if (innerWallItem.type === 'area') {
                        const cost = innerArea * innerWallItem.pricePerM2;
                        total += cost;
                        details.push({
                            name: `Внутрішня стінка: ${innerWall}`,
                            value: `${innerArea.toFixed(4)} м² × ${innerWallItem.pricePerM2} грн`,
                            cost
                        });
                    } else if (innerWallItem.type === 'perimeter') {
                        const perimeter = ((innerWidth + innerHeight) * 2) / 1000;
                        const cost = perimeter * innerWallItem.pricePerMeter;
                        total += cost;
                        details.push({
                            name: `Внутрішня стінка: ${innerWall}`,
                            value: `${perimeter.toFixed(3)} м × ${innerWallItem.pricePerMeter} грн`,
                            cost
                        });
                    } else if (innerWallItem.type === 'combined') {
                        const areaCost = innerArea * innerWallItem.pricePerM2;
                        const perimeter = ((innerWidth + innerHeight) * 2) / 1000;
                        const perimeterCost = perimeter * innerWallItem.pricePerMeter;
                        const combinedCost = areaCost + perimeterCost;
                        total += combinedCost;
                        details.push({
                            name: `Внутрішня стінка: ${innerWall}`,
                            value: `ДВП ${innerArea.toFixed(4)} м² + Підрамник ${perimeter.toFixed(3)} м`,
                            cost: combinedCost
                        });
                    }
                }

                const glassItem = data.components.glass.find(item => item.name === glass);
                if (glassItem && glassItem.pricePerM2 > 0) {
                    const glassArea = (innerWidth * innerHeight) / 1000000;
                    const glassCost = glassArea * glassItem.pricePerM2;
                    total += glassCost;
                    details.push({
                        name: `Скло: ${glass}`,
                        value: `${glassArea.toFixed(4)} м² × ${glassItem.pricePerM2} грн`,
                        cost: glassCost
                    });
                }

                const backWallItem = data.components.backWall.find(item => item.name === backWall);
                if (backWallItem && backWallItem.pricePerM2 > 0) {
                    const backWidth = (outerWidth - 3) / 1000;
                    const backHeight = (outerHeight - 3) / 1000;
                    const backArea = backWidth * backHeight;
                    const backCost = backArea * backWallItem.pricePerM2;
                    total += backCost;
                    details.push({
                        name: `Задня стінка: ${backWall}`,
                        value: `${backArea.toFixed(4)} м² × ${backWallItem.pricePerM2} грн`,
                        cost: backCost
                    });
                }

                const mountingItem = data.components.mounting.find(item => item.name === mounting);
                if (mountingItem && mountingItem.price > 0) {
                    total += mountingItem.price;
                    details.push({
                        name: `Кріплення: ${mounting}`,
                        value: `${mountingItem.price} грн`,
                        cost: mountingItem.price
                    });
                }

                const workTypeItem = data.workTypes.find(item => item.name === workType);
                if (workTypeItem) {
                    total += workTypeItem.price;
                    details.push({
                        name: `Робота: ${workType}`,
                        value: `${workTypeItem.price} грн`,
                        cost: workTypeItem.price
                    });
                }

                return { total, details };
            }, [selectedBaguette, width, height, withPassepartout, selectedPassepartout1, passepartout1Field,
                showPassepartout2, selectedPassepartout2, passepartout2Field, innerWall, glass, backWall, mounting, workType, data]);

            return (
                <div className="min-h-screen bg-gray-50 p-6">
                    <div className="max-w-3xl mx-auto">
                        <div className="bg-white rounded-lg shadow-sm p-6 mb-6">
                            <h1 className="text-2xl font-semibold text-gray-900">Калькулятор вартості рамок</h1>
                            <p className="text-sm text-gray-600 mt-1">Розрахунок вартості оформлення фото та вишивок</p>
                        </div>

                        {loading && (
                            <div className="bg-blue-50 rounded-lg shadow-sm p-6 mb-6 text-center">
                                <div className="text-blue-600">Завантаження даних з Google Sheets...</div>
                            </div>
                        )}

                        {error && (
                            <div className="bg-amber-50 rounded-lg shadow-sm p-4 mb-6 border border-amber-200">
                                <div className="text-sm text-amber-800">⚠️ {error}</div>
                            </div>
                        )}

                        <div className="bg-white rounded-lg shadow-sm p-6 space-y-6">

                            {/* 1. Baguette */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Багет *</label>
                                <div className="relative">
                                    <div className="relative">
                                        <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                            <SearchIcon />
                                        </div>
                                        <input
                                            type="text"
                                            value={baguetteSearch}
                                            onChange={(e) => {
                                                setBaguetteSearch(e.target.value);
                                                setSelectedBaguette(null);
                                            }}
                                            placeholder="Почніть вводити артикул (напр. AM1515-015)"
                                            className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        />
                                    </div>

                                    {filteredBaguettes.length > 0 && !selectedBaguette && (
                                        <div className="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto">
                                            {filteredBaguettes.map((item) => (
                                                <button
                                                    key={item.article}
                                                    onClick={() => {
                                                        setSelectedBaguette(item);
                                                        setBaguetteSearch(item.article);
                                                    }}
                                                    className="w-full px-4 py-2 text-left hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"
                                                >
                                                    <div className="font-medium text-gray-900">{item.article}</div>
                                                    <div className="text-sm text-gray-600">{item.pricePerMeter} грн/м</div>
                                                </button>
                                            ))}
                                        </div>
                                    )}
                                </div>
                                {selectedBaguette && (
                                    <div className="mt-2 text-sm text-green-600">
                                        ✓ Обрано: {selectedBaguette.article} ({selectedBaguette.pricePerMeter} грн/м)
                                    </div>
                                )}
                            </div>

                            {/* 2. Paspartu Mode */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Паспарту</label>
                                <div className="flex gap-4">
                                    <label className="flex items-center cursor-pointer">
                                        <input
                                            type="radio"
                                            checked={!withPassepartout}
                                            onChange={() => {
                                                setWithPassepartout(false);
                                                setShowPassepartout2(false);
                                            }}
                                            className="w-4 h-4 text-blue-600 focus:ring-blue-500"
                                        />
                                        <span className="ml-2 text-gray-700">Без паспарту</span>
                                    </label>
                                    <label className="flex items-center cursor-pointer">
                                        <input
                                            type="radio"
                                            checked={withPassepartout}
                                            onChange={() => setWithPassepartout(true)}
                                            className="w-4 h-4 text-blue-600 focus:ring-blue-500"
                                        />
                                        <span className="ml-2 text-gray-700">З паспарту</span>
                                    </label>
                                </div>
                            </div>

                            {/* 3. Dimensions */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    {withPassepartout ? 'Розмір вікна паспарту (мм) *' : 'Розміри (мм) *'}
                                </label>
                                <div className="grid grid-cols-2 gap-4">
                                    <input
                                        type="number"
                                        value={width}
                                        onChange={(e) => setWidth(e.target.value)}
                                        placeholder="Ширина"
                                        min="50"
                                        max="3000"
                                        className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    />
                                    <input
                                        type="number"
                                        value={height}
                                        onChange={(e) => setHeight(e.target.value)}
                                        placeholder="Висота"
                                        min="50"
                                        max="3000"
                                        className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    />
                                </div>
                            </div>

                            {/* 4. Paspartu Details */}
                            {withPassepartout && (
                                <div className="space-y-4 p-4 bg-gray-50 rounded-md">
                                    <div className="space-y-3">
                                        <label className="block text-sm font-medium text-gray-700">
                                            {showPassepartout2 ? 'Паспарту (нижнє)' : 'Паспарту'}
                                        </label>
                                        <div className="relative">
                                            <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                                <SearchIcon />
                                            </div>
                                            <input
                                                type="text"
                                                value={passepartout1Search}
                                                onChange={(e) => {
                                                    setPassepartout1Search(e.target.value);
                                                    setSelectedPassepartout1(null);
                                                }}
                                                placeholder="Пошук паспарту"
                                                className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            />
                                            {filteredPassepartout1.length > 0 && !selectedPassepartout1 && (
                                                <div className="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto">
                                                    {filteredPassepartout1.map((item) => (
                                                        <button
                                                            key={item.article}
                                                            onClick={() => {
                                                                setSelectedPassepartout1(item);
                                                                setPassepartout1Search(item.article);
                                                            }}
                                                            className="w-full px-4 py-2 text-left hover:bg-gray-100"
                                                        >
                                                            <div className="font-medium text-gray-900">{item.article}</div>
                                                            <div className="text-sm text-gray-600">{item.name}</div>
                                                        </button>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                        <input
                                            type="number"
                                            value={passepartout1Field}
                                            onChange={(e) => setPassepartout1Field(e.target.value)}
                                            placeholder={showPassepartout2 ? "Видима ширина поля (мм)" : "Ширина поля (мм)"}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        />
                                    </div>

                                    {showPassepartout2 && (
                                        <div className="space-y-3 pt-3 border-t border-gray-200">
                                            <div className="flex items-center justify-between">
                                                <label className="block text-sm font-medium text-gray-700">Паспарту (верхнє)</label>
                                                <button
                                                    onClick={() => {
                                                        setShowPassepartout2(false);
                                                        setSelectedPassepartout2(null);
                                                        setPassepartout2Search('');
                                                        setPassepartout2Field('');
                                                    }}
                                                    className="text-red-600 hover:text-red-700 p-1"
                                                >
                                                    <XIcon />
                                                </button>
                                            </div>
                                            <div className="relative">
                                                <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                                    <SearchIcon />
                                                </div>
                                                <input
                                                    type="text"
                                                    value={passepartout2Search}
                                                    onChange={(e) => {
                                                        setPassepartout2Search(e.target.value);
                                                        setSelectedPassepartout2(null);
                                                    }}
                                                    placeholder="Пошук паспарту"
                                                    className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                />
                                                {filteredPassepartout2.length > 0 && !selectedPassepartout2 && (
                                                    <div className="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto">
                                                        {filteredPassepartout2.map((item) => (
                                                            <button
                                                                key={item.article}
                                                                onClick={() => {
                                                                    setSelectedPassepartout2(item);
                                                                    setPassepartout2Search(item.article);
                                                                }}
                                                                className="w-full px-4 py-2 text-left hover:bg-gray-100"
                                                            >
                                                                <div className="font-medium text-gray-900">{item.article}</div>
                                                                <div className="text-sm text-gray-600">{item.name}</div>
                                                            </button>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                            <input
                                                type="number"
                                                value={passepartout2Field}
                                                onChange={(e) => setPassepartout2Field(e.target.value)}
                                                placeholder="Видима ширина поля (мм)"
                                                className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            />
                                        </div>
                                    )}

                                    {!showPassepartout2 && (
                                        <button
                                            onClick={() => setShowPassepartout2(true)}
                                            className="flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm font-medium"
                                        >
                                            <PlusIcon />
                                            Додати друге паспарту
                                        </button>
                                    )}
                                </div>
                            )}

                            {/* 5. Inner Wall */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Внутрішня стінка</label>
                                <select
                                    value={innerWall}
                                    onChange={(e) => setInnerWall(e.target.value)}
                                    className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                                    {data.components.innerWall.map((item) => (
                                        <option key={item.name} value={item.name}>{item.name}</option>
                                    ))}
                                </select>
                            </div>

                            {/* 6. Glass */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Скло</label>
                                <select
                                    value={glass}
                                    onChange={(e) => setGlass(e.target.value)}
                                    className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                                    {data.components.glass.map((item) => (
                                        <option key={item.name} value={item.name}>{item.name}</option>
                                    ))}
                                </select>
                            </div>

                            {/* 7. Back Wall */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Задня стінка</label>
                                <select
                                    value={backWall}
                                    onChange={(e) => setBackWall(e.target.value)}
                                    className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                                    {data.components.backWall.map((item) => (
                                        <option key={item.name} value={item.name}>{item.name}</option>
                                    ))}
                                </select>
                            </div>

                            {/* 8. Mounting */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Кріплення</label>
                                <select
                                    value={mounting}
                                    onChange={(e) => setMounting(e.target.value)}
                                    className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                                    {data.components.mounting.map((item) => (
                                        <option key={item.name} value={item.name}>{item.name}</option>
                                    ))}
                                </select>
                            </div>

                            {/* 9. Work Type */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Тип роботи</label>
                                <select
                                    value={workType}
                                    onChange={(e) => setWorkType(e.target.value)}
                                    className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                >
                                    {data.workTypes.map((item) => (
                                        <option key={item.name} value={item.name}>{item.name}</option>
                                    ))}
                                </select>
                            </div>
                        </div>

                        {calculations.total > 0 && (
                            <div className="bg-blue-50 rounded-lg shadow-sm p-6 mt-6 border-2 border-blue-200">
                                <div className="text-center">
                                    <div className="text-sm font-medium text-gray-600 mb-1">Загальна вартість</div>
                                    <div className="text-4xl font-bold text-blue-600">
                                        {calculations.total.toFixed(2)} грн
                                    </div>
                                </div>

                                {SHOW_ITEM_PRICES && calculations.details.length > 0 && (
                                    <div className="mt-6 pt-6 border-t border-blue-200">
                                        <div className="text-sm font-medium text-gray-700 mb-3">Деталізація:</div>
                                        <div className="space-y-2">
                                            {calculations.details.map((detail, idx) => (
                                                <div key={idx} className="flex justify-between text-sm">
                                                    <span className="text-gray-600">{detail.name}</span>
                                                    <span className="font-medium text-gray-900">{detail.cost.toFixed(2)} грн</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        <div className="bg-white rounded-lg shadow-sm p-6 mt-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-3">Інструкція з підключення Google Sheets</h2>
                            <div className="text-sm text-gray-600 space-y-2">
                                <p>1. Створіть Google Таблицю з такою структурою:</p>
                                <div className="bg-gray-50 p-3 rounded-md font-mono text-xs space-y-2">
                                    <div>
                                        <strong>Вкладка "Багет":</strong><br />
                                        Артикул | Модель | Колір | Ціна_за_метр | Ширина_профілю | Додатковий_розмір
                                    </div>
                                    <div>
                                        <strong>Вкладка "Паспарту":</strong><br />
                                        Артикул | Назва | Ціна_за_м2
                                    </div>
                                    <div>
                                        <strong>Вкладка "Внутрішня_стінка":</strong><br />
                                        Назва | Ціна_за_м2 | Ціна_за_метр | Тип
                                    </div>
                                    <div>
                                        <strong>Вкладка "Скло":</strong><br />
                                        Назва | Ціна_за_м2
                                    </div>
                                    <div>
                                        <strong>Вкладка "Задня_стінка":</strong><br />
                                        Назва | Ціна_за_м2
                                    </div>
                                    <div>
                                        <strong>Вкладка "Кріплення":</strong><br />
                                        Назва | Ціна
                                    </div>
                                    <div>
                                        <strong>Вкладка "Роботи":</strong><br />
                                        Назва | Ціна
                                    </div>
                                </div>
                                <p>2. Зробіть таблицю публічною (Файл → Налаштування спільного доступу → Будь-хто з посиланням може переглядати)</p>
                                <p>3. Скопіюйте URL таблиці та замініть у коді константу GOOGLE_SHEETS_ID</p>
                                <p className="text-amber-600 font-medium">⚠️ Поки що калькулятор працює з тестовими даними, якщо не вдалося завантажити з Google Sheets</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<FrameCalculator />, document.getElementById('root'));
    </script>
</body>

</html>